---
title: 应用接口
tags: API
description: 测试引擎应用接口说明
---

# 应用接口

## 概览

用户可以通过调用接口将测试引擎嵌入到上位机软件中，框架安装完成后用户可以在LabVIEW程序框图功能选板中的“Test Bench Framework”选板中获取应用接口。

<img title="API" src="../assets/img/2025-08-28 144446.png" alt="loading-ag-178">

## 接口说明

### Start Engine

启动测试引擎，调用这个接口会启动一个测试引擎的副本，可以调用多次，程序结束时必须调用“Stop Engine”否则程序会在后台挂起。

<img title="API" src="../assets/img/2025-08-28 160234.png" alt="loading-ag-178">

| 参数               | 类型      | 描述                                          |
|:---------------- |:-------:|:------------------------------------------- |
| Process          | String  | 线程ID，这个ID必须是唯一的在多个产品测试的情况下，需要通过这个ID来识别对应的工站 |
| Number of Socket | Int32   | 当前工站的槽位总数                                   |
| Error in         | Cluster | 错误输入                                        |

| 返回值                       | 类型           | 描述                                         |
|:------------------------- |:------------:|:------------------------------------------ |
| Test Executive Manage out | Class Refnum | 测试引擎实例                                     |
| Event Registration Refnum | Refnum       | 测试引擎事件源，用户可以通过事件结构注册事件来获取测试引擎执行过程中的事件数据返回值 |
| Error out                 | Cluster      | 错误输出                                       |

### Stop Engine

停止测试引擎。

<img title="API" src="../assets/img/2025-08-28 160906.png" alt="loading-ag-178">

| 参数                       | 类型           | 描述     |
|:------------------------ |:------------:|:------ |
| Test Executive Manage in | Class Refnum | 测试引擎实例 |
| Error in                 | Cluster      | 错误输入   |

| 返回值       | 类型      | 描述   |
|:--------- |:-------:|:---- |
| Error out | Cluster | 错误输出 |

### Test Engine Configuration

配置测试引擎，启动测试引擎后必须调用一次，可以在程序运行的时候通过调用这个借口来动态修改测试引擎的配置。

<img title="API" src="../assets/img/2025-08-28 170612.png" alt="loading-ag-178">

| 参数                                                                                                                                                              | 类型           | 描述       |
|:--------------------------------------------------------------------------------------------------------------------------------------------------------------- |:------------:|:-------- |
| Test Executive Manage in                                                                                                                                        | Class Refnum | 测试引擎实例   |
| [TestEngine Cofiguration](https://xiongxinwei-code.github.io/test-bench-framework/docs/%E5%8F%82%E6%95%B0%E7%BB%93%E6%9E%84%E4%BD%93#Test Engine Configuration) | Cluster      | 测试引擎配置参数 |
| Error in                                                                                                                                                        | Cluster      | 错误输入     |

| 返回值                       | 类型           | 描述     |
|:------------------------- |:------------:|:------ |
| Test Executive Manage out | Class Refnum | 测试引擎实例 |
| Error out                 | Cluster      | 错误输出   |

### Binding Object

测试引擎过程数据绑定到控件，在执行测试序列的时候过程数据可以自动刷新到控件中，如果不使用这个接口，在序列执行的时候需要通过测试引擎的事件反馈值来获取过程数据并且刷新到控件中。

<img title="API" src="../assets/img/2025-08-29 103031.png" alt="loading-ag-178">

| 参数                                                                                                                                                                       | 类型           | 描述                 |
|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |:------------:|:------------------ |
| Test Executive Manage in                                                                                                                                                 | Class Refnum | 测试引擎实例             |
| Socket                                                                                                                                                                   | Int32        | 槽位号，控件和槽位数据通过槽位号绑定 |
| Items List Reference                                                                                                                                                     | Refnum       | 测试项列表控件的引用         |
| [Result](https://xiongxinwei-code.github.io/test-bench-framework/docs/%E5%8F%82%E6%95%B0%E7%BB%93%E6%9E%84%E4%BD%93#Result)                  | Cluster      | 结果控件的引用簇           |
| ColWidth                                                                                                                                                                 | Cluster      | 测试项列表控件的列宽配置参数     |
| Error in                                                                                                                                                                 | Cluster      | 错误输入               |

| 返回值                       | 类型           | 描述     |
|:------------------------- |:------------:|:------ |
| Test Executive Manage out | Class Refnum | 测试引擎实例 |
| Error out                 | Cluster      | 错误输出   |
